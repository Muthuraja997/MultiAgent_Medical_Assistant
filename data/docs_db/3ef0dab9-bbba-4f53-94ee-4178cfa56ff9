## Experimental setup

Keras Python deep learning library on top of TensorFlow was utilized for implementing CNN models on a machine with the following specification; an   Intel ®  Core™ i7 CPU@ 3.6 GHz with 32 GB RAM and a Titan × Pascal Graphics Processing Unit (GPU). Extensive experiments were carried out to obtain the best settings of the CNN models that achieve the best possible results. It is worth noting that the pre-processing for enhancing the images has been carried out using   MATLAB ® 18 software.

Both the full and segmented datasets with their enhanced versions have been used to train VGG19 and EfficientNetB0 CNN pre-trained models. The training was carried on with Adam optimizer, learning rate of 0.001, batch size of 32, and the number of epochs (10-30) epochs, SoftMax classifier. The fine-tuned pre-trained models were used for feature extraction; therefore, the weights of the pre-trained models were frozen, and they were not updated during the training to maintain ImageNet's initial weights. The top layers were fine-tuned to adjust the

picture_counter_14 The image illustrates a workflow involving chest X-ray images and deep learning models. It shows original and enhanced X-ray images (Original, Enhanced HE, Enhanced CLAHE, Complement) being processed through segmentation using a mask. Both the original/enhanced images and the segmented images are fed into two transfer learning models: VGG19 and EfficientNetB0.

Complement

Figure 4. The framework of the used methodology for Chest X-ray images classification.

<!-- page_break -->

network according to the used chest X-ray data and to the current problem output which is (2/4) rather than 1000 in the ImageNet data. To avoid overfitting, a dropout of 0.3 was applied in the fully connected layers. Figures 5 and 6 illustrate the fine-tuned top layers based on VGG19 and EfficientNetB0 respectively for binary classification.